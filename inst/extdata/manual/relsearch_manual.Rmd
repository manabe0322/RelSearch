---
title: "RelSearch version 1.0.0 user manual"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

```{css, echo = FALSE}
body{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
  font-size: 16px;
  color: #333333;
}

table, th, td{
  font-size: 14px;
  color: #333333;
}

h1{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

h2{
  padding: 1rem 2rem;
  background: #f4f4f4;
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

h3{
  padding: 1rem 2rem;
  border-left: 4px solid #333333;
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

h4{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

p{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}
```

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(data.table)
library(DT)
```

---

## Initial setup

1. Ensure that R (>= 4.3.3) is installed. It is available from the <a href="http://www.R-project.org" target="_blank">R Development Core Team website</a>.

2. Begin an R session.

3. Execute the following command in R to install required packages.

```
install.packages(c("shiny", "data.table", "dplyr", "DT", "magrittr", "pandoc", "pedtools", "Rcpp", "ribd", "rmarkdown", "shinyFeedback", "shinyjs", "shinythemes", "waiter"))
```

4. Download ”relsearch_1.0.0.zip” from the <a href="https://github.com/manabe0322/relsearch/releases" target="_blank">GitHub repository page</a>.

5. Install ”relsearch_1.0.0.zip” from ”Install package(s) from local files...”.

---

## Quick guide

1. Execute the following commands in R to start GUI.

```
library(relsearch)
relsearch()
```

<br>

2. Load files from each **"Browse..."** button.

<img src="fig_quick_1.jpg" width="80%">

**Note** See section [Files](#sec_files) for information on each file.

<br>

3. Click the **"Analysis"** button.

<img src="fig_quick_2.jpg" width="80%">

<br>

4. After finishing the analysis, the result window is automatically opened.

<img src="fig_quick_3.jpg" width="80%">

**Note** See section [Result](#sec_result) for navigation of the result window.

<br>

5. Select **Project** ▶ **Save project**.

<img src="fig_quick_4.jpg" width="80%">

<br>

6. Enter the project name and click the **"Save as"** button.

<img src="fig_quick_5.jpg" width="80%">

**Note** The saved project can be loaded from **Project** ▶ **Load project**. How to handle projects is described in section [Other functions](#sec_other_func).

<br>

---

<a id="sec_files"></a>

## Files

### STR: Victim database

```{r, echo = FALSE}
dt_v_auto_ex <- data.table(SampleName = c("Victim1", "Victim2", "Victim3", "Victim4", "Victim5", "Victim6", "Victim7", "Victim8", "Victim9", "Victim10", "︙"), 
                           D3S1358 = c("17", "17", "15", "15", "15", "16", "14", "16", "15", "15", "︙"), 
                           D3S1358 = c("17", "", "17", "18", "15", "16", "15", "18", "15", "16", "︙"), 
                           vWA = c("17", "18", "17", "15", "18", "17", "17", "17", "16", "18", "︙"), 
                           vWA = c("", "18", "18", "18", "", "", "18", "18", "18", "19", "︙"), 
                           D16S539 = c("11", "", "10", "9", "9", "", "12", "11", "11", "9", "︙"), 
                           D16S539 = c("", "", "10", "12", "9", "", "", "", "11", "10", "︙"), 
                           CSF1PO = c("12", "10", "10", "11", "10", "10", "", "9", "12", "12", "︙"), 
                           CSF1PO = c("", "11", "12", "12", "", "13", "", "12", "12", "12", "︙"), 
                           TPOX = c("", "8", "8", "8", "9", "8", "8", "8", "8", "8", "︙"), 
                           TPOX = c("", "", "11", "8", "11", "8", "8", "", "11", "11", "︙"))
datatable(dt_v_auto_ex, 
          selection = "none",
          options = list(dom = "t", iDisplayLength = nrow(dt_v_auto_ex), ordering = FALSE, autowidth = TRUE),
          rownames = FALSE)
```

**Note**

* File type: .csv

* This file requires the column "SampleName" and columns for each marker (two columns in each).

* The marker with two empty cells (e.g., TPOX of sample "Victim1" in the above table) is ignored when calculating the likelihood ratio.

* The marker with one empty cell (e.g., vWA of sample "Victim1" in the above table) can be regarded as both homozygote (i.e., no drop-out) and heterozygote with drop-out of one allele when calculating the likelihood ratio.

<br>

### STR: Reference database

```{r, echo = FALSE}
dt_r_auto_ex <- data.table(SampleName = c("Reference1", "Reference2", "Reference3", "Reference4", "Reference5", "Reference6", "Reference7", "Reference7", "Reference8", "Reference9", "Reference10", "︙"), 
                           Relationship = c("Father_Son", "Father_Son", "Father_Son", "Father_Son", "Brother_Brother", "Brother_Brother", "Brother_Brother", "Father_Son", "Brother_Brother", "Uncle_Nephew", "Uncle_Nephew", "︙"),
                           D3S1358 = c("17", "17", "15", "15", "15", "16", "16", "16", "15", "15", "15", "︙"), 
                           D3S1358 = c("17", "18", "16", "16", "16", "17", "17", "17", "16", "15", "16", "︙"), 
                           vWA = c("14", "17", "17", "15", "15", "17", "14", "14", "17", "14", "17", "︙"), 
                           vWA = c("17", "18", "18", "18", "18", "17", "18", "18", "18", "16", "", "︙"), 
                           D16S539 = c("10", "12", "9", "9", "9", "10", "9", "9", "9", "10", "9", "︙"), 
                           D16S539 = c("10", "13", "10", "9", "9", "12", "9", "9", "12", "11", "12", "︙"), 
                           CSF1PO = c("12", "10", "11", "10", "10", "13", "12", "12", "11", "11", "", "︙"), 
                           CSF1PO = c("12", "11", "12", "12", "12", "13", "15", "15", "12", "12", "", "︙"), 
                           TPOX = c("8", "11", "8", "9", "9", "9", "8", "8", "8", "8", "8", "︙"), 
                           TPOX = c("8", "11", "8", "11", "11", "11", "8", "8", "9", "9", "12", "︙"))
datatable(dt_r_auto_ex, 
          selection = "none",
          options = list(dom = "t", iDisplayLength = nrow(dt_r_auto_ex), ordering = FALSE, autowidth = TRUE),
          rownames = FALSE)
```

**Note**

* File type: .csv

* This file requires the columns "SampleName", "Relationship", and columns for each marker (two columns in each).

* The relationship of a missing family member should be designated in the column "Relationship". The names of the relationship need to be pre-defined in **Settings** ▶ **Relationships** (see section [Setting](#sec_setting_rel)).

* If a reference has multiple missing family members, add rows for each relationship of the members (e.g., sibling and parent-child of the sample "Reference7" in the above table).

* The marker with two empty cells (e.g., CSF1PO of sample "Reference10" in the above table) is ignored when calculating the likelihood ratio.

* The marker with one empty cell (e.g., vWA of sample "Reference10" in the above table) can be regarded as both homozygote (i.e., no drop-out) and heterozygote with drop-out of one allele when calculating the likelihood ratio.

<br>

### STR: Allele frequencies

```{r, echo = FALSE}
dt_af_ex <- data.table(Allele = c("10", "10.1", "10.2", "10.3", "11", "11.1", "11.2", "11.3", "12", "12.2", "13", "13.2", "14", "︙"), 
                       D3S1358 = c("", "", "", "", "", "", "", "", "0.02324", "", "0.001328", "", "0.02656", "︙"), 
                       vWA = c("", "", "", "", "", "", "", "", "", "", "0.000664", "", "0.194887", "︙"), 
                       D16S539 = c("0.200266", "", "", "", "0.186981", "", "", "", "0.172036", "", "0.069744", "", "0.008967", "︙"), 
                       CSF1PO = c("0.215471", "", "", "", "0.206175", "", "", "", "0.420983", "", "0.069389", "", "0.017596", "︙"), 
                       TPOX = c("0.033566", "", "", "", "0.356597", "", "", "", "0.038219", "", "0.001329", "", "0.000997", "︙"))
datatable(dt_af_ex, 
          selection = "none",
          options = list(dom = "t", iDisplayLength = nrow(dt_af_ex), ordering = FALSE, autowidth = TRUE),
          rownames = FALSE)
```

**Note**

* File type: .csv

* This file requires the columns "Allele" and columns for each marker (one column in each).

<br>

### Y-STR: Victim database

```{r, echo = FALSE}
dt_v_y_ex <- data.table()
```

**Note**

* File type: .csv

* This file requires the column "SampleName" and columns for each marker (one column in each).

* In the marker with more than one allele, each allele must be separated by a comma without any spaces (e.g., DYS385).

* The marker with an empty cell (e.g., DYS456 of sample ‘Victim6’) is ignored for analysis.

<br>

### Y-STR: Reference database

```{r, echo = FALSE}
dt_r_y_ex <- data.table()
```

**Note**

* File type: .csv

* This file requires the column "SampleName", "Relationship", and columns for each marker (one column in each).

* The relationship of a missing family member should be designated in the column "Relationship". The name of the relationship should be defined in Settings > Relationships.

* If a reference has multiple missing family members, add rows for each relationship of the members (e.g., sibling and parent-child of the sample "Reference7" in the above table).

* In the marker with more than one allele, each allele must be separated by a comma without any spaces (e.g., DYS385).

* The marker with an empty cell (e.g., DYS518 of sample ‘Reference10’) is ignored for analysis.

<br>

### mtDNA: Victim database

```{r, echo = FALSE}
dt_v_mt_ex <- data.table()
```

**Note**

* File type: .csv

* This file requires the column "SampleName", "Range", and "Haplotype".

<br>

### mtDNA: Reference database

```{r, echo = FALSE}
dt_r_mt_ex <- data.table()
```

**Note**

* File type: .csv

* This file requires the column "SampleName", "Relationship", "Range", and "Haplotype".

* The relationship of a missing family member should be designated in the column "Relationship". The name of the relationship should be defined in Settings > Relationships.

* If a reference has multiple missing family members, add rows for each relationship of the members (e.g., sibling and parent-child of the sample "Reference7" in the above table).

<br>

---

<a id="sec_setting"></a>

## Setting

### Criteria

<a id="sec_setting_rel"></a>

### Relationship

### Mutation rate

### Other parameters

---

<a id="sec_result"></a>

## Result

---

<a id="sec_other_func"></a>

## Other functions

### Project

### View database

### Example files

---

## Computational principle

### STR

### Y-STR

### mtDNA

