---
title: "RelSearch version 1.0.0 user manual"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

```{css, echo = FALSE}
body{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
  font-size: 16px;
  color: #333333;
}

table, th, td{
  font-size: 14px;
  color: #333333;
}

h1{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

h2{
  padding: 1rem 2rem;
  background: #f4f4f4;
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

h3{
  padding: 1rem 2rem;
  border-left: 4px solid #333333;
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

h4{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}

p{
  font-family: "Helvetica Neue", "Helvetica", "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Arial", "Yu Gothic", "Meiryo", sans-serif;
}
```

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(data.table)
library(DT)
```

---

## Initial setup

1. Ensure that R (>= 4.3.3) is installed. It is available from the <a href="http://www.R-project.org" target="_blank">R Development Core Team website</a>.

2. Begin an R session.

3. Execute the following command in R to install required packages.

```
install.packages(c("shiny", "data.table", "dplyr", "DT", "magrittr", "pandoc", "pedtools", "Rcpp", "ribd", "rmarkdown", "shinyFeedback", "shinyjs", "shinythemes", "waiter"))
```

4. Download ”relsearch_1.0.0.zip” from the <a href="https://github.com/manabe0322/relsearch/releases" target="_blank">GitHub repository page</a>.

5. Install ”relsearch_1.0.0.zip” from ”Install package(s) from local files...”.

---

## Quick guide

1. Execute the following commands in R to start GUI.

```
library(relsearch)
relsearch()
```

<br>

2. Load files from each **"Browse..."** button.

<img src="fig_quick_1.jpg" width="80%">

<br>

3. Click the **"Analysis"** button.

<img src="fig_quick_2.jpg" width="80%">

<br>

4. After finishing the analysis, the result window is automatically opened.

<img src="fig_quick_3.jpg" width="80%">

**Note** See section [Result](#sec_result) for navigation of the result window

<br>

5. Select **Project** ▶ **Save project**.

<img src="fig_quick_4.jpg" width="80%">

<br>

6. Enter the project name and click the **"Save as"** button.

<img src="fig_quick_5.jpg" width="80%">

**Note** The saved project can be loaded from **Project** ▶ **Load project**. How to handle projects is described in section [Other functions](#sec_other_func).

<br>

---

<a id="sec_files"></a>

## Files

### STR: Victim database

```{r, echo = FALSE}
dt_v_auto_ex <- data.table(SampleName = c("Victim1", "Victim2", "Victim3", "︙"), 
                           D3S1358 = c("17", "17", "15", "︙"), 
                           D3S1358 = c("17", "", "17", "︙"), 
                           vWA = c("17", "18", "17", "︙"), 
                           vWA = c("", "18", "18", "︙"), 
                           D16S539 = c("11", "", "10", "︙"), 
                           D16S539 = c("", "", "10", "︙"), 
                           CSF1PO = c("12", "10", "10", "︙"), 
                           CSF1PO = c("", "11", "12", "︙"), 
                           TPOX = c("", "8", "8", "︙"), 
                           TPOX = c("", "", "11", "︙"))
datatable(dt_v_auto_ex, 
          selection = "none",
          options = list(dom = "t", iDisplayLength = nrow(dt_v_auto_ex), ordering = FALSE, autowidth = TRUE),
          rownames = FALSE)
```

**Note**

* File type: .csv

* This file requires the column "SampleName" and columns for each marker (two columns in each).

* The marker with two empty cells (e.g., TPOX of sample "Victim1" in the above table) is ignored when calculating the likelihood ratio.

* The marker with one empty cell (e.g., vWA of sample "Victim1" in the above table) can be regarded as both homozygote (i.e., no drop-out) and heterozygote with drop-out of one allele when calculating the likelihood ratio.

<br>

### STR: Reference database

```{r, echo = FALSE}
dt_r_auto_ex <- data.table(SampleName = c("Reference1", "Reference2", "Reference3", "︙"), 
                           Relationship = c("Father_Son", "Father_Son", "Brother_Brother"),
                           D3S1358 = c("17", "17", "15", "︙"), 
                           D3S1358 = c("17", "", "17", "︙"), 
                           vWA = c("17", "18", "17", "︙"), 
                           vWA = c("", "18", "18", "︙"), 
                           D16S539 = c("11", "", "10", "︙"), 
                           D16S539 = c("", "", "10", "︙"), 
                           CSF1PO = c("12", "10", "10", "︙"), 
                           CSF1PO = c("", "11", "12", "︙"), 
                           TPOX = c("", "8", "8", "︙"), 
                           TPOX = c("", "", "11", "︙"))
datatable(dt_r_auto_ex, 
          selection = "none",
          options = list(dom = "t", iDisplayLength = nrow(dt_r_auto_ex), ordering = FALSE, autowidth = TRUE),
          rownames = FALSE)
```

**Note**

* File type: .csv

* This file requires the columns "SampleName", "Relationship", and columns for each marker (two columns in each).

* The relationship of a missing family member should be designated in the column "Relationship". The name of the relationship should be defined in Settings > Relationships.

* If a reference has multiple missing family members, add rows for each relationship of the members (e.g., sibling and parent-child of the sample "Reference7" in the above table).

* The marker with two empty cells (e.g., CSF1PO of sample "Reference10" in the above table) is ignored when calculating the likelihood ratio.

* The marker with one empty cell (e.g., vWA of sample "Reference10" in the above table) can be regarded as both homozygote (i.e., no drop-out) and heterozygote with drop-out of one allele when calculating the likelihood ratio.

<br>

### STR: Allele frequencies

### Y-STR: Victim database

### Y-STR: Reference database

### mtDNA: Victim database

### mtDNA: Reference database

---

<a id="sec_setting"></a>

## Setting

### Criteria

### Relationship

### Mutation rate

### Other parameters

---

<a id="sec_result"></a>

## Result

---

<a id="sec_other_func"></a>

## Other functions

### Project

### View database

### Example files

---

## Computational principle

### STR

### Y-STR

### mtDNA

